---
title: Relearn React 04-React Hooks
date: 2024-02-19 18:30:00
---

# React Hooks

### 为什么要有 React Hooks

- 类组件和函数组件的区别

  - 类组件继承了`React.Component`, 从中获取声明周期函数、state/setState 状态维护等大而全的能力，也导致了较重的学习和理解成本。
  - 函数组件起初并不具备这些能力，是一种无状态组件。React Hooks 的存在使得开发者能够按需钩入所如功能，完成轻量灵活、易于维护的组件。
  - 心智模型上的区别：面向对象编程和函数式编程

### React 为什么选择了函数组件

#### 1.React 组件的本质 `UI = render(data)`

- React 组件本身定位就是一个函数，一个吃进数据、吐出 UI 的函数。
- 把声明式的代码转换为命令式的 DOM 操作，把数据层面的描述映射到用户可兼得 UI 变化中去。
- **_故 React 中的数据应该总是紧紧和渲染绑定在一起的。_**

#### 2.函数组件会捕获 render 内部的状态，这是两类组件组大的不同

函数组件是真正地把数据和渲染绑定到了一起。

- 函数组件的每次渲染都是依靠函数调用时捕获到状态包括 props、当时的 state，新的 props 或 state 会造成 re-render；
- 而类组件渲染时从`this`上获取状态数据，这些数据是实时可变的，当 setTimeout 等导致数据实时性和渲染不一致时就会带来 bug。

### React Hooks 使用原则

#### Rule1：只在 React 函数中调用 Hook

#### Rule2：不要在循环、条件或嵌套函数中调用 Hook

> 保证 Hooks 在每次渲染中保持同样地执行顺序

Hooks 本质上是一个链表

- 首次渲染 mountState()构建链表并渲染。updateState()依次遍历链表并渲染。
- 通过依次遍历来获取每个 hook 的内容，若在不同渲染中 Hooks 的执行顺序不一致，则获取的内容就会出现错误。
