---
title: Relearn React 05-虚拟DOM
date: 2024-02-19 20:30:00
---

# 虚拟 DOM (Virtual DOM)

### 虚拟 DOM 是什么(WHAT)

虚拟 DOM 本质上是 JS 和 DOM 之间的一个映射缓存，在形态上表现为一个能描述 DOM 结构及其属性的 JS 对象。

### 虚拟 DOM 在 React 中是如何工作的(HOW)

- 在挂载阶段，React.createElement()将 JSX 构建成虚拟 DOM 树，然后通过 ReactDOM.render()将虚拟 DOM 渲染为真实 DOM；
- 在更新阶段，页面的变化先作用于虚拟 DOM，虚拟 DOM 在 JS 层借助 Diff 算法比较出跟先前页面的差别，然后将这些差别作用于真实 DOM；

### 为什么需要虚拟 DOM(WHY)

- 提高了研发效率和研发体验：为数据驱动视图这一理念提供了高度可用的载体，使得开发者可以实现高效的声明式编程。
- 解决了跨平台问题：同一套虚拟 DOM 可以对接不同平台的渲染逻辑，从而实现一次编码多端运行。
- 性能上的优势：JS 操作远比 DOM 操作耗时少，通过 Diff 算法触发 patch 进行`差量更新`，在大多数情况下具有较好的性能。但 Diff 出来的结果接近于全量更新时，由于多出 Diff 过程的耗时而不具备性能优势。
- 虚拟 DOM 库中为提高性能还会通过 batch()函数进行`批量更新`：差量更新速度非常快的情况下，用户只能看到最后一次更新效果。batch 函数缓冲每次生成的补丁集到队列中，再将最后的结果交给渲染函数，最终实现集中化的 DOM 批量更新，避免了短时间内的多次高耗能 DOM 操作。
